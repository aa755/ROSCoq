<html>
<head>
<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="expires" content="0" />
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
<meta http-equiv="pragma" content="no-cache" />
<title> ROSCoq Installation </title>
</head>

<body>

  <h3>
Instructions for compiling the Coq development 
  </h3>
  <p>
  Our development is known to compile with Coq versions 8.4pl2 and 8.4pl3.
  It depends on an earlier (January 2015) version of the 
  <a href="http://corn.cs.ru.nl/">CoRN</a> library, 
  which in turn depends on the <a href="https://coq.inria.fr/cocorico/MathClasses">MathClasses</a> library.
  Like CoRN, we use the <a href="http://www.scons.org/">SCons</a> 
  build tool to compile our Coq files in a correct order.
  <a href="http://git-scm.com/">Git</a> is required to download the right
  version of CoRN from <a href="https://github.com/c-corn/corn">github</a>.
  </p>
  
  The best way to compile our coq development is to install
  Ubuntu 14.04 (in a <a href="https://www.virtualbox.org/">virtual machine</a> 
  if you don't want to change the main OS of your computer).
  The following steps have been tested on a fresh install of 
  <a href="http://www.ubuntu.com/download/desktop/contribute/?version=14.04.2&architecture=amd64">Ubuntu 14.04.2 LTS</a>:
  <ol> 
    <li>Install Coq version 8.4pl3, SCons and git
      by the following command:
      <br>
      <br>
      <code> abhishek@abhishek-desktop:~$ sudo apt-get install scons coq git</code>
      <br>
      <br>
    </li>
    <li>
      Download our sources from <a href="dist.zip">here</a>.
      Extract it to a place of your choice. This step can also be done
      via command line using as follows:
      <br>
      <br>
      <code> abhishek@abhishek-desktop:~$ wget www.cs.cornell.edu/~aa755/ROSCoq/dist.zip</code>
      <br>
      <code> abhishek@abhishek-desktop:~$ unzip dist.zip</code>
      <br>
      <br>
      
    </li>
    <li>
      We have included a script <code>installDependencies.sh</code>
      which creates a new subdirectory <code>dependencies</code>,
      clones CoRN's github repository and checks out
      the version known to work for ROSCoq. Finally, it compiles CoRN.
      This might take several hours. If you have several free cores
      on your computer (say 4), replace  <code>scons</code> in
      <code>installDependencies.sh</code> by 
      <code>scons -j4</code>, so that upto 4 Coq files can be
      compiled in parallel. This step of editing  <code>installDependencies.sh</code>
      is optional. After that, run
      the script as follows:
      <br>
      <br>
      <code> abhishek@abhishek-desktop:~$ cd dist</code>
      <br>
      <code> abhishek@abhishek-desktop:~/dist$ bash -x  installDependencies.sh</code>
      <br>
      <br>
    </li>
   <li> Finally, compile our Coq development by entering the <code>dist/coq/</code> 
      and running scons :
      <br>
      <br>
      <code> abhishek@abhishek-desktop:~/dist$ cd coq</code>
      <br>
      <code> abhishek@abhishek-desktop:~/dist/coq$ scons</code>
      <br>
      <br>
      Again, feel free to replace <code>scons</code> in the above by 
      <code>scons -j4</code> for parallelism.
      Our Coq development is in  <code>dist/coq/</code>.
      To interactively examine these files,
      use the script <code>dist/coq/coqidescript.sh</code>.
      Instead of opening <code>coqide</code> directly,
      using this script ensures that the Coq loadpaths are
      set correctly. Here is an example usage:
      <br>
      <br>
      <code> abhishek@abhishek-desktop:~/dist/coq$ bash coqidescript.sh icreate.v</code>
      <br>
      <br>
    </li>
  </ol>
    If you run into any issues, please anonymously send an email to 
    <a href="mailto:aa755@cornell.edu">Abhishek Anand</a>

<h3>
Instructions for installing ROS, ROSJava  and the drivers for iRobot create.
</h3>
  <ol>
    <li> <a href="installROS.html">Install and test ROS Indigo and iRobot Create drivers</a> </li>    
    <li> <a href="installROSJava.html">Install ROSJava and compile the ROSCoq Shim</a> </li>    
  </ol>

<h3>
Directly using our Virtual Machine
</h3>
<p>
We have created a VirtualBox VM
with Coq, ROSCoq's Coq development, ROS, 
ROSJava and the ROSCoq shim preinstalled.
It has been created
by following the above instructions on a fresh install of 
<a href="http://www.ubuntu.com/download/desktop/contribute/?version=14.04.2&architecture=amd64">Ubuntu 14.04.2 LTS</a>
</p>
However, you might encounter USB hardware issues while using this VM.
The key issue is that the iCreate robot will (obviously) be 
physically connected to a USB port of the host of the VM and needs to somehow
be passed through to the Guest (VM).
There are known issues in USB pass through mechanisms of VirtualBox.
<br>
We had success with an Ubuntu (14.04) host, but not a Windows (8.1) host
with only USB 3.0 ports.
Try plugging your iCreate to a USB 2.0 port on the host.
Also, the image has been created and tested with VirtualBox version 4.3.26.
It might be a good idea to use the same or higher version of VirtualBox.

<br>
If you plan to use this VM image, you can skip all the above instructions
and follow the ones below:

  <ol>
    <li>Install <a href="https://www.virtualbox.org/">VirtualBox</a>.  </li>
    <li>Download the VM Image (coming soon). We are trying to find out how to distribute the VM image
      which is <em>3.1GB</em> in size. </li>
    <li>Import this .ova file in VirtualBox by clicking at File | Import Appliance. 
         In this process, VirtualBox will let you change the RAM and number of CPU's 
          allocated to the VM. It is recommended that you change these values
          if they are respectively greater than what is available in your host machine.
    </li>
    <li>Set up USB pass through : Go to USB settings of the imported VM and check "Enable USB 2.0 (EHCI) Controller". 
        On a linux host, there is an additional step of adding your account to the 
        <code>vboxusers</code> group :
        <br>
        <br>
        <code> abhishek@abhishek-desktop:~$ sudo usermod -G vboxusers -a $USER</code>
        <br>
        <br>
    </li>
    <li>
        Start the Virtual Machine. Login with password "abcd".
    </li>
    <li>Connect the iCreate to the computer (host of the VM) and click on Devices | USB Devices | FTDI ... 
        to get the iCreate device passed through to the guest (VM). After this, 
         <code>ls /dev/ttyUSB*</code> on the guest should return  <code>/dev/ttyUSB0</code>.
    </li>
  </ol>


<h3>
Instructions for running the Coq program on an iCreate robot
</h3>
<a href="runROSCoq.html">Run the Coq program on your robot</a>

<!--so that one can easily run Coq programs on their 
      iRobot <a href="http://www.irobot.com/For-the-Home/Vacuum-Cleaning/Roomba.aspx"> Roomba</a> 
      or <a href="http://www.irobot.com/About-iRobot/STEM/Create-2.aspx"> Create</a>
-->

</body>
</html>
